# Accessibility (A11y)

## Contents
- WCAG 2.1 Standards
- Semantic HTML
- ARIA Attributes
- Keyboard Navigation
- Color and Contrast
- Accessible Components
- Testing Accessibility
- Critical Rules

Building inclusive, accessible web applications.

## WCAG 2.1 Standards

### Level AA (Target)
- Contrast ratio 4.5:1 for normal text
- Contrast ratio 3:1 for large text
- Focus visible on all interactive elements
- All content keyboard accessible

## Semantic HTML

```typescript
// ❌ Non-semantic
<div className="nav">
  <div onClick={() => navigate("/")} className="nav-item">Home</div>
</div>

// ✅ Semantic HTML
<nav aria-label="Main navigation">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/about">About</a></li>
  </ul>
</nav>

// Proper heading hierarchy
<article>
  <h1>Article Title</h1>
  <section>
    <h2>Section Title</h2>
    <h3>Subsection</h3>
  </section>
</article>

// Landmark regions
<header>
  <nav aria-label="Main">{/* Nav */}</nav>
</header>
<main>{/* Content */}</main>
<aside aria-label="Related">{/* Sidebar */}</aside>
<footer>{/* Footer */}</footer>
```

## ARIA Attributes

```typescript
// Icons
<button aria-label="Search">
  <SearchIcon aria-hidden="true" />
</button>

// Form fields
<div>
  <label id="email-label" htmlFor="email">Email</label>
  <input
    id="email"
    type="email"
    aria-labelledby="email-label"
    aria-describedby="email-help"
    aria-invalid={hasError}
    aria-required="true"
  />
  <span id="email-help">We'll never share your email</span>
  {hasError && <span role="alert">Invalid email</span>}
</div>

// Expandable content
<button aria-expanded={isOpen} aria-controls="panel-1">
  Toggle
</button>
<div id="panel-1" hidden={!isOpen}>
  Content
</div>

// Live regions
<div role="status" aria-live="polite" aria-atomic="true">
  {message}
</div>

// Modal dialogs
<div role="dialog" aria-modal="true" aria-labelledby="dialog-title">
  <h2 id="dialog-title">Dialog Title</h2>
</div>
```

## Keyboard Navigation

```typescript
function Modal({ isOpen, onClose }: ModalProps) {
  const closeRef = useRef<HTMLButtonElement>(null);
  const modalRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (isOpen) {
      closeRef.current?.focus();

      const handleKeyDown = (e: KeyboardEvent) => {
        if (e.key === "Escape") onClose();

        if (e.key === "Tab") {
          const focusable = modalRef.current?.querySelectorAll(
            'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
          );
          if (!focusable?.length) return;

          const first = focusable[0] as HTMLElement;
          const last = focusable[focusable.length - 1] as HTMLElement;

          if (e.shiftKey && document.activeElement === first) {
            e.preventDefault();
            last.focus();
          } else if (!e.shiftKey && document.activeElement === last) {
            e.preventDefault();
            first.focus();
          }
        }
      };

      document.addEventListener("keydown", handleKeyDown);
      return () => document.removeEventListener("keydown", handleKeyDown);
    }
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  return (
    <div ref={modalRef} role="dialog" aria-modal="true">
      <button ref={closeRef} onClick={onClose}>Close</button>
    </div>
  );
}

// Skip link
<a
  href="#main-content"
  className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4"
>
  Skip to main content
</a>
```

## Color and Contrast

```typescript
// WCAG AA compliant colors
const colors = {
  text: {
    primary: "text-gray-900 dark:text-gray-100", // 4.5:1+
    secondary: "text-gray-600 dark:text-gray-400", // 4.5:1+
  },
  // Don't rely on color alone
  status: {
    success: "bg-green-100 text-green-900 border-2 border-green-600",
    error: "bg-red-100 text-red-900 border-2 border-red-600",
  },
};

// Focus indicators
const focusStyles = "focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2";
```

## Accessible Components

```typescript
// Tabs
function Tabs({ tabs }: { tabs: Tab[] }) {
  const [activeTab, setActiveTab] = useState(tabs[0].id);

  return (
    <div>
      <div role="tablist" aria-label="Tabs">
        {tabs.map((tab) => (
          <button
            key={tab.id}
            role="tab"
            aria-selected={activeTab === tab.id}
            aria-controls={`panel-${tab.id}`}
            id={`tab-${tab.id}`}
            tabIndex={activeTab === tab.id ? 0 : -1}
            onClick={() => setActiveTab(tab.id)}
          >
            {tab.label}
          </button>
        ))}
      </div>
      {tabs.map((tab) => (
        <div
          key={tab.id}
          role="tabpanel"
          id={`panel-${tab.id}`}
          aria-labelledby={`tab-${tab.id}`}
          hidden={activeTab !== tab.id}
          tabIndex={0}
        >
          {tab.content}
        </div>
      ))}
    </div>
  );
}

// Loading button
<button disabled={loading} aria-busy={loading}>
  {loading && <span className="spinner" aria-hidden="true" />}
  <span>{loading ? "Loading..." : children}</span>
</button>

// Visually hidden text
<button>
  <TrashIcon aria-hidden="true" />
  <span className="sr-only">Delete item</span>
</button>
```

## Testing Accessibility

```typescript
import { render } from "@testing-library/react";
import { axe, toHaveNoViolations } from "jest-axe";

expect.extend(toHaveNoViolations);

test("Button is accessible", async () => {
  const { container } = render(<Button>Click me</Button>);
  const results = await axe(container);
  expect(results).toHaveNoViolations();
});
```

## Critical Rules

### Always
- Use semantic HTML elements
- Provide text alternatives
- Ensure keyboard navigation
- Test with screen readers
- Meet WCAG 2.1 AA

### Never
- Skip alt text for images
- Use divs for interactive elements
- Rely on color alone
- Trap keyboard focus
- Ignore focus indicators
